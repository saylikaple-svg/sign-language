<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI STUDIO</title>
  <style>
    :root{
      --bg-grad: linear-gradient(135deg,#2a004a 0%, #0a0016 50%, #000000 100%);
      --accent-grad: linear-gradient(135deg,#7c3aed 0%, #4c1d95 40%, #000 100%);
      --user-grad: linear-gradient(135deg,#7c3aed 0%, #000 100%);
      --ai-grad: linear-gradient(135deg,#0a0016 0%, #2a004a 60%, #000 100%);
      --purple: #7c3aed;
      --white: #ffffff;
      --muted: #a7a7b4;
      --card: rgba(255,255,255,0.06);
      --card2: rgba(255,255,255,0.08);
      --glass: rgba(255,255,255,0.04);
      --border: rgba(255,255,255,0.12);
      --shadow: 0 10px 30px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.06);
      --radius: 18px;
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body{
      margin:0; color:var(--white); font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: var(--bg-grad);
      background-attachment: fixed;
      overflow: hidden;
    }

    /* Top bar */
    .topbar{
      position: sticky; top:0; z-index:20;
      display:flex; align-items:center; gap:.75rem;
      padding: 14px 18px;
      backdrop-filter: blur(10px);
      background: linear-gradient(180deg, rgba(0,0,0,0.45), rgba(0,0,0,0.15) 70%, transparent);
      border-bottom: 1px solid var(--border);
    }
    .logo{
      width:36px; height:36px; border-radius:12px;
      background: var(--accent-grad);
      display:grid; place-items:center;
      box-shadow: var(--shadow);
    }
    .logo svg{ filter: drop-shadow(0 2px 6px rgba(124,58,237,.45)); }
    .brand{ font-weight: 800; letter-spacing:.4px; font-size: 1.05rem; }

    /* Layout */
    .wrap{ height: calc(100% - 64px); display:flex; flex-direction: column; }
    .chat{
      flex:1 1 auto; overflow: auto; padding: 18px; scroll-behavior: smooth;
    }

    /* Welcome / hero */
    .welcome{
      max-width: 900px; margin: 18px auto 0; position: relative;
      display:flex; align-items: center; gap: 22px; padding: 20px; border-radius: var(--radius);
      background: radial-gradient(80% 120% at 0% 0%, rgba(124,58,237,0.20) 0%, rgba(124,58,237,0.06) 45%, rgba(0,0,0,0.0) 100%);
      border: 1px solid var(--border);
    }
    .welcome h1{ margin: 0 0 6px; font-size: clamp(20px, 2.6vw, 32px); }
    .welcome p{ margin: 0; color: var(--muted); }

    /* Cute 3D-ish robot */
    .robot-scene{
      width: 160px; height: 160px; perspective: 700px; flex: 0 0 auto;
      display:grid; place-items:center;
    }
    .robot{
      width: 120px; height: 120px; position: relative; transform-style: preserve-3d;
      animation: float 3.4s ease-in-out infinite;
    }
    @keyframes float{ 0%,100%{ transform: translateY(0) rotateY(-8deg) rotateX(6deg);} 50%{ transform: translateY(-10px) rotateY(8deg) rotateX(-4deg);} }
    .head{
      position:absolute; top:10px; left:50%; transform: translateX(-50%);
      width: 88px; height: 64px; border-radius: 18px; background: var(--card2); border:1px solid var(--border); box-shadow: var(--shadow);
    }
    .eye{ position:absolute; top:22px; width:16px; height:16px; border-radius:50%; background: radial-gradient(circle at 40% 40%, #88f, #44c, #111);
      box-shadow: 0 0 10px #88f;
      animation: blink 4s infinite;
    }
    .eye.left{ left:20px; }
    .eye.right{ right:20px; }
    @keyframes blink{ 0%, 48%, 52%, 100% { transform: scaleY(1); } 50% { transform: scaleY(0.1); } }
    .antenna{
      position:absolute; top:-10px; left:50%; transform: translateX(-50%);
      width:4px; height:14px; background: var(--purple); border-radius:2px;
    }
    .antenna::after{ content:""; position:absolute; top:-8px; left:50%; transform: translateX(-50%);
      width:10px; height:10px; border-radius:50%; background: #c4b5fd; box-shadow: 0 0 10px #c4b5fd;
      animation: pulse 1.8s ease-in-out infinite;
    }
    @keyframes pulse{ 0%,100%{ transform: translateX(-50%) scale(1);} 50%{ transform: translateX(-50%) scale(1.25);} }
    .body{
      position:absolute; bottom:0; left:50%; transform: translateX(-50%);
      width: 110px; height: 80px; border-radius: 22px; background: var(--card);
      border:1px solid var(--border); box-shadow: var(--shadow);
    }
    .body::after{ content:"AI"; position:absolute; bottom:10px; right:12px; font-weight:800; font-size: 14px; color:#c4b5fd; opacity:.7; }

    /* Messages */
    .messages{ max-width: 900px; margin: 0 auto; display:flex; flex-direction: column; gap: 12px; }

    .msg{ display:flex; gap:10px; align-items:flex-end; }
    .msg.user{ justify-content: flex-end; }

    .bubble{
      max-width: 78%; padding: 12px 14px; border-radius: 16px; line-height: 1.45; white-space: pre-wrap; word-wrap: break-word;
      border: 1px solid var(--border); box-shadow: var(--shadow);
    }
    .bubble.user{
      background: var(--user-grad); color: var(--white);
      border-top-right-radius: 6px;
    }
    .bubble.ai{
      background: #0b0b12; color: var(--white);
      background-image: var(--ai-grad);
      border-top-left-radius: 6px;
    }
    .avatar{ width: 34px; height: 34px; border-radius: 10px; background: var(--accent-grad); display:grid; place-items:center; box-shadow: var(--shadow); }

    /* Typing dots */
    .typing{ display:inline-flex; gap:6px; }
    .typing span{ width:6px; height:6px; border-radius:50%; background:#c4b5fd; opacity:.7; animation: jump 1.2s infinite; }
    .typing span:nth-child(2){ animation-delay:.2s; }
    .typing span:nth-child(3){ animation-delay:.4s; }
    @keyframes jump{ 0%, 60%, 100%{ transform: translateY(0);} 30%{ transform: translateY(-6px);} }

    /* Composer */
    .composer-wrap{
      position: sticky; bottom: 0; left: 0; right: 0; z-index: 30;
      padding: 12px 14px; backdrop-filter: blur(10px);
      background: linear-gradient(0deg, rgba(0,0,0,0.65), rgba(0,0,0,0.25) 60%, rgba(0,0,0,0.0));
      border-top: 1px solid var(--border);
    }
    .composer{
      max-width: 900px; margin: 0 auto; display:flex; gap: 10px; align-items: center;
      background: var(--glass); border:1px solid var(--border); border-radius: 16px; padding: 8px;
      box-shadow: var(--shadow);
    }
    textarea{
      flex: 1; resize: none; min-height: 46px; max-height: 120px; border: none; outline: none;
      background: transparent; color: var(--white); font-size: 15px; line-height: 1.35;
    }
    .send{
      flex: 0 0 auto; display:inline-flex; align-items:center; gap:8px;
      padding: 10px 14px; border-radius: 12px; border:1px solid var(--border);
      background: var(--accent-grad); color: var(--white); cursor: pointer;
      font-weight: 700; letter-spacing:.3px;
      box-shadow: var(--shadow); transition: transform .06s ease;
    }
    .send:active{ transform: translateY(1px); }

    /* Small helpers */
    .sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }

   /* Mobile-first adjustments */
@media (max-width: 768px) {
  .welcome { flex-direction: column; text-align: center; padding: 12px; }
  .bubble { max-width: 92%; }
  .composer { padding: 6px; gap: 6px; }
  textarea { font-size: 14px; }
  .send { padding: 8px 10px; font-size: 14px; }
}

@media (max-width: 480px) {
  .brand { font-size: 0.9rem; }
  .chat { padding: 10px; }
  .bubble { max-width: 95%; font-size: 14px; }
}

  </style>
</head>
<body>
  <header class="topbar" role="banner">
    <div class="logo" aria-hidden="true">
      <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M4 12a8 8 0 1116 0v4.5a2.5 2.5 0 01-5 0V12a3 3 0 00-6 0v4.5a2.5 2.5 0 01-5 0V12z" stroke="white" stroke-width="1.3"/>
      </svg>
    </div>
    <div class="brand">QUICKCURE</div>
  </header>

  <main class="wrap" role="main">
    <section id="chat" class="chat" aria-live="polite">
      <!-- Welcome panel (hidden after first message) -->
      <div id="welcome" class="welcome">
        <div class="robot-scene" aria-hidden="true">
          <div class="robot">
            <div class="antenna"></div>
            <div class="head">
              <div class="eye left"></div>
              <div class="eye right"></div>
            </div>
            <div class="body"></div>
          </div>
        </div>
        <div>
          <h1>Welcome to <span style="color:#c4b5fd">QUICKCURE</span></h1>
          <p>How can I help you?</p>
        </div>
      </div>

      <div id="messages" class="messages" role="log"></div>
    </section>

    <!-- Composer -->
    <div class="composer-wrap">
      <form id="composer" class="composer" autocomplete="off">
        <label class="sr-only" for="prompt">Type your message</label>
        <textarea id="prompt" placeholder="Ask anythingâ€¦" rows="1"></textarea>
        <button type="submit" class="send" id="sendBtn">
          <span>Send</span>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M5 12h9" stroke="white" stroke-width="1.6" stroke-linecap="round"/>
            <path d="M13 5l7 7-7 7" stroke="white" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </form>
    </div>
  </main>

  <script>
    // ============== CONFIG ==============
    const API_KEY = "AIzaSyCyhF__jK6nZMUEqfzr4qOJPoHed9NLywc"; //  aip key for gemini-1.5-flash-latest
    const MODEL = "gemini-1.5-flash-latest"; // fast and capable; change to gemini-1.5-pro-latest if you have access

    // ============== HELPERS ==============
    const el = (sel, root = document) => root.querySelector(sel);
    const messagesEl = el('#messages');
    const welcomeEl = el('#welcome');
    const promptEl = el('#prompt');
    const formEl = el('#composer');

    function createMsg({ role, html }){
      const row = document.createElement('div');
      row.className = `msg ${role === 'user' ? 'user' : 'ai'}`;

      const avatar = document.createElement('div');
      avatar.className = 'avatar';
      avatar.innerHTML = role === 'user'
        ? '<svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 12a5 5 0 100-10 5 5 0 000 10zM3 21a9 9 0 0118 0" stroke="white" stroke-width="1.5"/></svg>'
        : '<svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 12a8 8 0 1116 0v4.5a2.5 2.5 0 01-5 0V12a3 3 0 00-6 0v4.5a2.5 2.5 0 01-5 0V12z" stroke="white" stroke-width="1.5"/></svg>';

      const bubble = document.createElement('div');
      bubble.className = `bubble ${role === 'user' ? 'user' : 'ai'}`;
      bubble.innerHTML = html;

      if (role === 'user') { row.appendChild(bubble); row.appendChild(avatar); }
      else { row.appendChild(avatar); row.appendChild(bubble); }
      return { row, bubble };
    }

    function addTyping(){
      const { row, bubble } = createMsg({ role: 'ai', html: '<span class="typing"><span></span><span></span><span></span></span>' });
      messagesEl.appendChild(row);
      scrollBottom();
      return { row, bubble };
    }

    function scrollBottom(){
      // ensures new content is visible
      messagesEl.parentElement.scrollTop = messagesEl.parentElement.scrollHeight;
    }

    function sanitize(text){
      // Basic escape to avoid HTML injection
      return text.replace(/[&<>\"]/g, s => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[s]));
    }

    // ============== AI CALL ==============
    async function callGemini(prompt){
      const url = `https://generativelanguage.googleapis.com/v1beta/models/${MODEL}:generateContent?key=${encodeURIComponent(API_KEY)}`;
      const body = {
        contents: [{ role: 'user', parts: [{ text: prompt }]}],
        generationConfig: { temperature: 0.7, topP: 0.95, maxOutputTokens: 1024 }
      };
      const res = await fetch(url, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(body)
      });
      if (!res.ok) {
        const msg = await res.text();
        throw new Error(`API error ${res.status}: ${msg}`);
      }
      const data = await res.json();
      const text = data?.candidates?.[0]?.content?.parts?.map(p => p.text).join('\n') || 'No response.';
      return text;
    }

    // ============== APP LOGIC ==============
    let sentFirst = false;

    function hideWelcome(){
      if (!sentFirst && welcomeEl) {
        welcomeEl.style.display = 'none';
        sentFirst = true;
      }
    }

    async function handleSend(e){
      e?.preventDefault();
      const prompt = promptEl.value.trim();
      if (!prompt) return;

      hideWelcome();

      // Show user bubble
      const userMsg = createMsg({ role: 'user', html: sanitize(prompt) });
      messagesEl.appendChild(userMsg.row);
      promptEl.value = '';
      promptEl.style.height = '46px';
      scrollBottom();

      // Show typing indicator
      const typing = addTyping();

      try {
        const aiText = await callGemini(prompt);
        typing.bubble.innerText = aiText;
      } catch(err){
        console.error(err);
        typing.bubble.innerHTML = `<strong>Oops.</strong> ${sanitize(err.message)}<br/><small style="color:#c4b5fd;opacity:.8">Tip: Using API keys in the browser can expose them. Consider a small server proxy.</small>`;
      } finally {
        scrollBottom();
      }
    }

    // Autosize textarea
    promptEl.addEventListener('input', () => {
      promptEl.style.height = 'auto';
      promptEl.style.height = Math.min(promptEl.scrollHeight, 120) + 'px';
    });

    formEl.addEventListener('submit', handleSend);

    // Send with Ctrl/Cmd+Enter
    promptEl.addEventListener('keydown', (e) => {
      if ((e.metaKey || e.ctrlKey) && e.key === 'Enter') {
        handleSend(e);
      }
    });

    // Focus input on load
    window.addEventListener('load', () => promptEl.focus());
  </script>
</body>
</html>